library("neuralnet")

data <- read.csv("C:/Users/Luca/Documents/GitHub/DM/TrainingData/unione01forclass.csv", header = TRUE)

trainingdata <- data

testdata <- data
testdata$Id  <- NULL

net <- neuralnet(Class~FNC1 + FNC2 + FNC3 + FNC4 + FNC5 + FNC6 + FNC7 + FNC8 + FNC9 + FNC10 + FNC11 + FNC12 + FNC13 + FNC14 + FNC15 + FNC16 + FNC17 + FNC18 + FNC19 + FNC20 + FNC21 + FNC22 + FNC23 + FNC24 + FNC25 + FNC26 + FNC27 + FNC28 + FNC29 + FNC30 + FNC31 + FNC32 + FNC33 + FNC34 + FNC35 + FNC36 + FNC37 + FNC38 + FNC39 + FNC40 + FNC41 + FNC42 + FNC43 + FNC44 + FNC45 + FNC46 + FNC47 + FNC48 + FNC49 + FNC50 + FNC51 + FNC52 + FNC53 + FNC54 + FNC55 + FNC56 + FNC57 + FNC58 + FNC59 + FNC60 + FNC61 + FNC62 + FNC63 + FNC64 + FNC65 + FNC66 + FNC67 + FNC68 + FNC69 + FNC70 + FNC71 + FNC72 + FNC73 + FNC74 + FNC75 + FNC76 + FNC77 + FNC78 + FNC79 + FNC80 + FNC81 + FNC82 + FNC83 + FNC84 + FNC85 + FNC86 + FNC87 + FNC88 + FNC89 + FNC90 + FNC91 + FNC92 + FNC93 + FNC94 + FNC95 + FNC96 + FNC97 + FNC98 + FNC99 + FNC100 + FNC101 + FNC102 + FNC103 + FNC104 + FNC105 + FNC106 + FNC107 + FNC108 + FNC109 + FNC110 + FNC111 + FNC112 + FNC113 + FNC114 + FNC115 + FNC116 + FNC117 + FNC118 + FNC119 + FNC120 + FNC121 + FNC122 + FNC123 + FNC124 + FNC125 + FNC126 + FNC127 + FNC128 + FNC129 + FNC130 + FNC131 + FNC132 + FNC133 + FNC134 + FNC135 + FNC136 + FNC137 + FNC138 + FNC139 + FNC140 + FNC141 + FNC142 + FNC143 + FNC144 + FNC145 + FNC146 + FNC147 + FNC148 + FNC149 + FNC150 + FNC151 + FNC152 + FNC153 + FNC154 + FNC155 + FNC156 + FNC157 + FNC158 + FNC159 + FNC160 + FNC161 + FNC162 + FNC163 + FNC164 + FNC165 + FNC166 + FNC167 + FNC168 + FNC169 + FNC170 + FNC171 + FNC172 + FNC173 + FNC174 + FNC175 + FNC176 + FNC177 + FNC178 + FNC179 + FNC180 + FNC181 + FNC182 + FNC183 + FNC184 + FNC185 + FNC186 + FNC187 + FNC188 + FNC189 + FNC190 + FNC191 + FNC192 + FNC193 + FNC194 + FNC195 + FNC196 + FNC197 + FNC198 + FNC199 + FNC200 + FNC201 + FNC202 + FNC203 + FNC204 + FNC205 + FNC206 + FNC207 + FNC208 + FNC209 + FNC210 + FNC211 + FNC212 + FNC213 + FNC214 + FNC215 + FNC216 + FNC217 + FNC218 + FNC219 + FNC220 + FNC221 + FNC222 + FNC223 + FNC224 + FNC225 + FNC226 + FNC227 + FNC228 + FNC229 + FNC230 + FNC231 + FNC232 + FNC233 + FNC234 + FNC235 + FNC236 + FNC237 + FNC238 + FNC239 + FNC240 + FNC241 + FNC242 + FNC243 + FNC244 + FNC245 + FNC246 + FNC247 + FNC248 + FNC249 + FNC250 + FNC251 + FNC252 + FNC253 + FNC254 + FNC255 + FNC256 + FNC257 + FNC258 + FNC259 + FNC260 + FNC261 + FNC262 + FNC263 + FNC264 + FNC265 + FNC266 + FNC267 + FNC268 + FNC269 + FNC270 + FNC271 + FNC272 + FNC273 + FNC274 + FNC275 + FNC276 + FNC277 + FNC278 + FNC279 + FNC280 + FNC281 + FNC282 + FNC283 + FNC284 + FNC285 + FNC286 + FNC287 + FNC288 + FNC289 + FNC290 + FNC291 + FNC292 + FNC293 + FNC294 + FNC295 + FNC296 + FNC297 + FNC298 + FNC299 + FNC300 + FNC301 + FNC302 + FNC303 + FNC304 + FNC305 + FNC306 + FNC307 + FNC308 + FNC309 + FNC310 + FNC311 + FNC312 + FNC313 + FNC314 + FNC315 + FNC316 + FNC317 + FNC318 + FNC319 + FNC320 + FNC321 + FNC322 + FNC323 + FNC324 + FNC325 + FNC326 + FNC327 + FNC328 + FNC329 + FNC330 + FNC331 + FNC332 + FNC333 + FNC334 + FNC335 + FNC336 + FNC337 + FNC338 + FNC339 + FNC340 + FNC341 + FNC342 + FNC343 + FNC344 + FNC345 + FNC346 + FNC347 + FNC348 + FNC349 + FNC350 + FNC351 + FNC352 + FNC353 + FNC354 + FNC355 + FNC356 + FNC357 + FNC358 + FNC359 + FNC360 + FNC361 + FNC362 + FNC363 + FNC364 + FNC365 + FNC366 + FNC367 + FNC368 + FNC369 + FNC370 + FNC371 + FNC372 + FNC373 + FNC374 + FNC375 + FNC376 + FNC377 + FNC378 + SBM_map1 + SBM_map2 + SBM_map3 + SBM_map4 + SBM_map5 + SBM_map6 + SBM_map7 + SBM_map8 + SBM_map10 + SBM_map13 + SBM_map17 + SBM_map22 + SBM_map26 + SBM_map28 + SBM_map32 + SBM_map36 + SBM_map40 + SBM_map43 + SBM_map45 + SBM_map48 + SBM_map51 + SBM_map52 + SBM_map55 + SBM_map61 + SBM_map64 + SBM_map67 + SBM_map69 + SBM_map71 + SBM_map72 + SBM_map73 + SBM_map74 + SBM_map75,trainingdata, hidden=10,algorithm = "backprop",err.fct ="ce", learningrate = 1.5,linear.output = FALSE, threshold=0.8, rep = 10, lifesign = "full")

net.results <- compute(net, testdata[2:411])
commit <- within(as.data.frame(net.results$net.result), V1[V1<0.5] <- 0)
commit <- within(commit, V1[V1>0.5] <- 1)
cleanoutput <- cbind(testdata[,411],as.data.frame(net.results$net.result),commit,abs(commit-testdata[,411]))
cleanoutput
sum(cleanoutput[,4])
1 - sum(cleanoutput[,4])/length(cleanoutput[,1])